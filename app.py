from fastapi import FastAPI
from pydantic import BaseModel
import subprocess

class MyURL(BaseModel):
    url: str

app = FastAPI(
     title="VulScan"
)

@app.get("/")
def index():
    return "Hello World"
    
@app.post("/whois")
def whois(myurl:MyURL):
	process = subprocess.Popen(['whois', myurl.url ,'-H'], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
	out, err = process.communicate()
	return out
	
@app.post("/whatweb")
def whatweb(myurl:MyURL):
	process = subprocess.Popen(['whatweb', myurl.url], stdout=subprocess.PIPE, stderr=subprocess.PIPE)
	out, err = process.communicate()
	return out

@app.post("/scan")
def get_student(item:MyURL):
    return item.url


